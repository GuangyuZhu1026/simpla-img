<link rel="import" href="../polymer/polymer.html"> <link rel="import" href="../simpla-element-behavior/simpla-element-behavior.html"> <dom-module id="simpla-img"> <script>!function(){"use strict";var t=document.createElement("simpla-img-editor"),e=!1,i={observers:["_updateEditorImage(active)","_ensureEditorReady(editable)"],_updateEditorImage:function(e){t.image=e?this:null},_ensureEditorReady:function(i){if(i&&!e){var r=this.resolveUrl("simpla-img-editor.html"),a=document.createElement("link");a.rel="import",a.setAttribute("async",!0),a.href=r,document.head.appendChild(a),document.body.appendChild(t),e=!0}}},r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAACCAQAAAA3fa6RAAAADklEQVR42mNkAANGCAUAACMAA2w/AMgAAAAASUVORK5CYII=",a={width:180,height:130},n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},l=function(){function t(t,e){var i=[],r=!0,a=!1,n=void 0;try{for(var l,o=t[Symbol.iterator]();!(r=(l=o.next()).done)&&(i.push(l.value),!e||i.length!==e);r=!0);}catch(t){a=!0,n=t}finally{try{!r&&o.return&&o.return()}finally{if(a)throw n}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o={editable:{cursor:"pointer"},active:{visibility:"hidden",transition:"visibility",transitionDelay:"50ms"},placeholder:{minHeight:a.height+"px",minWidth:a.width+"px",backgroundSize:"cover",backgroundPosition:"center center",opacity:"0.75"}},s={is:"simpla-img",extends:"img",properties:{src:{type:String,reflectToAttribute:!0,value:function(){return r},notify:!0},alt:{type:String,reflectToAttribute:!0,value:"",notify:!0},placeholder:{type:String,value:""},editable:{type:Boolean,reflectToAttribute:!0,notify:!0,value:!1},active:{type:Boolean,notify:!0,value:!1}},observers:["_styleEditable(editable)","_styleEditing(active)","_showPlaceholder(placeholder, editable, src)"],listeners:{tap:"_tapHandler"},behaviors:[SimplaBehaviors.Element,i],created:function(){this.setupSimpla({type:"Image",dataProperties:["src","alt"],getCallback:"_updateElement",setCallback:"_updateSimpla"})},_styleEditable:function(t){this._toggleStyles(o.editable,t)},_styleEditing:function(t){this._toggleStyles(o.active,t)},_showPlaceholder:function(t,e,i){var a=e&&i===r,l=void 0;t||(t="url("+this.resolveUrl("placeholder.gif")+")"),l=n({background:t},o.placeholder),this._toggleStyles(l,a)},_toggleStyles:function(t,e){var i=this,r=this.__styleCache=this.__styleCache||{};(function(t){return Object.keys(t).map(function(e){return[e,t[e]]})})(t).forEach(function(t){var a=l(t,2),n=a[0],o=a[1],s=r[n],c=i.style[n];e?r[n]=c:(r[n]="",o=s||""),i.style[n]=o})},_updateElement:function(t){this.__comingFromSimpla=!0,n(this,t.data),this.__comingFromSimpla=!1},_updateSimpla:function(){if(this.path&&!this.__comingFromSimpla&&this.src!==r)return Simpla.set(this.path,{type:"Image",data:{src:this.src,alt:this.alt}})},_tapHandler:function(){this.editable&&(this.active=!0)}};Polymer(s)}()</script> </dom-module> 